2025-03-14 22:59:50 - DEBUG - app.dependencies - Authentication cache expired for token: eyJhbGciOi...
2025-03-14 22:59:50 - DEBUG - app.dependencies - Authenticating user with token: eyJhbGciOi...
2025-03-14 22:59:50 - DEBUG - app.dependencies - Decoding JWT token with SECRET_KEY: cf7d7...
2025-03-14 22:59:50 - DEBUG - app.dependencies - Decoded JWT token, user_email: sunkay.subscriptions@gmail.com
2025-03-14 22:59:50 - DEBUG - app.dependencies - Found user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 22:59:50 - INFO - app.routers.emails - [API] Email sync requested for user 2b743c51-aa25-4472-98d4-f15f3df955b1 (email: sunkay.subscriptions@gmail.com)
2025-03-14 22:59:50 - INFO - app.routers.emails - [API] Sync parameters: use_current_date=False, force_full_sync=False
2025-03-14 22:59:50 - INFO - app.routers.emails - [API] Starting sync process at 2025-03-14T22:59:50.490325
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - ╔══════════════════════════════════════════════════════════════════════════╗
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - ║                  STARTING EMAIL SYNC                                     ║
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - ╚══════════════════════════════════════════════════════════════════════════╝
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - User: sunkay.subscriptions@gmail.com
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - Time: 2025-03-15T02:59:50.490415+00:00
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - Last sync: 2025-03-15 02:58:17.175796+00:00
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - History ID: 1949521
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - ╔══════════════════════════════════════════════════════════════════════════╗
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - ║                  PROCESSING EA → GMAIL OPERATIONS                        ║
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - ╚══════════════════════════════════════════════════════════════════════════╝
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - [SYNC] Processing pending operations with user credentials
2025-03-14 22:59:50 - INFO - app.services.email_operations_service - [OPS] Found 0 pending operations for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 22:59:50 - INFO - app.services.email_operations_service - [OPS] No pending operations for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - [SYNC] Operations processing completed successfully
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - No pending EA → GMAIL operations to process
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - ╔══════════════════════════════════════════════════════════════════════════╗
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - ║                  FETCHING GMAIL → EA CHANGES                             ║
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - ╚══════════════════════════════════════════════════════════════════════════╝
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - Using history ID: 1949521
2025-03-14 22:59:50 - DEBUG - app.services.gmail - [GMAIL] Using cached Gmail service
2025-03-14 22:59:50 - INFO - app.services.gmail - [GMAIL] Fetching history page 1 starting at history ID 1949521
2025-03-14 22:59:50 - DEBUG - app.services.gmail - [GMAIL] New history ID updated to 1949690
2025-03-14 22:59:50 - INFO - app.services.gmail - [GMAIL] Page 1 contains 9 history events
2025-03-14 22:59:50 - DEBUG - app.services.gmail - [GMAIL] Processing history event: dict_keys(['id', 'messages'])
2025-03-14 22:59:50 - DEBUG - app.services.gmail - [GMAIL] Processing history event: dict_keys(['id', 'messages'])
2025-03-14 22:59:50 - DEBUG - app.services.gmail - [GMAIL] Processing history event: dict_keys(['id', 'messages'])
2025-03-14 22:59:50 - DEBUG - app.services.gmail - [GMAIL] Processing history event: dict_keys(['id', 'messages', 'messagesAdded'])
2025-03-14 22:59:50 - INFO - app.services.gmail - [GMAIL] New message detected with ID 19597be2d0fc5c48
2025-03-14 22:59:50 - DEBUG - app.services.gmail - [GMAIL] Processing history event: dict_keys(['id', 'messages'])
2025-03-14 22:59:50 - DEBUG - app.services.gmail - [GMAIL] Processing history event: dict_keys(['id', 'messages', 'messagesDeleted'])
2025-03-14 22:59:50 - INFO - app.services.gmail - [GMAIL] Deleted message detected: {'id': '19597be2d0fc5c48', 'threadId': '19597255ceb56bc9', 'labelIds': ['DRAFT', 'IMPORTANT']}
2025-03-14 22:59:50 - DEBUG - app.services.gmail - [GMAIL] Processing history event: dict_keys(['id', 'messages', 'messagesAdded'])
2025-03-14 22:59:50 - INFO - app.services.gmail - [GMAIL] New message detected with ID 19597be3c5a6cf45
2025-03-14 22:59:50 - DEBUG - app.services.gmail - [GMAIL] Processing history event: dict_keys(['id', 'messages'])
2025-03-14 22:59:50 - DEBUG - app.services.gmail - [GMAIL] Processing history event: dict_keys(['id', 'messages'])
2025-03-14 22:59:50 - INFO - app.services.gmail - [GMAIL] Sync complete: 9 history events, 1 new emails, 1 deleted emails, and 0 messages with label changes
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - GMAIL → EA Changes detected:
2025-03-14 22:59:50 - INFO - app.services.email_sync_service -   - 1 new emails
2025-03-14 22:59:50 - INFO - app.services.email_sync_service -     1. New: 'Fwd: 2025-03-14 23:42:35 (M6.0) South Sa...' from Unknown sender
2025-03-14 22:59:50 - INFO - app.services.email_sync_service -   - 1 deleted emails
2025-03-14 22:59:50 - INFO - app.services.email_sync_service -     1. Deleted: 19597be2d0fc5c48
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - History ID changed: 1949521 → 1949690
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - [SYNC] Found 0 emails with pending category updates
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - [SYNC] Processing summary:
2025-03-14 22:59:50 - INFO - app.services.email_sync_service -   - Total emails found: 1
2025-03-14 22:59:50 - INFO - app.services.email_sync_service -   - Already processed: 0
2025-03-14 22:59:50 - INFO - app.services.email_sync_service -   - New emails to process: 1
2025-03-14 22:59:50 - INFO - app.services.email_sync_service -   - Deleted emails to process: 1
2025-03-14 22:59:50 - INFO - app.services.email_sync_service -   - Label changes processed: 0
2025-03-14 22:59:50 - INFO - app.services.email_sync_service -   - Category updates processed: 0
2025-03-14 22:59:50 - INFO - app.services.email_sync_service -   - Operations processed: 0
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - ╔══════════════════════════════════════════════════════════════════════════╗
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - ║                  SYNC COMPLETED SUCCESSFULLY                             ║
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - ╚══════════════════════════════════════════════════════════════════════════╝
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - Bidirectional sync summary:
2025-03-14 22:59:50 - INFO - app.services.email_sync_service -   EA → GMAIL:
2025-03-14 22:59:50 - INFO - app.services.email_sync_service -     - Operations processed: 0
2025-03-14 22:59:50 - INFO - app.services.email_sync_service -     - Operations succeeded: 0
2025-03-14 22:59:50 - INFO - app.services.email_sync_service -   GMAIL → EA:
2025-03-14 22:59:50 - INFO - app.services.email_sync_service -     - New emails: 1
2025-03-14 22:59:50 - INFO - app.services.email_sync_service -     - Deleted emails: 1
2025-03-14 22:59:50 - INFO - app.services.email_sync_service -     - Label changes: 0
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - [SYNC] Processing 1 new emails for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 22:59:50 - INFO - app.services.email_processor - [PROCESSOR] Starting to process 1 emails for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 22:59:50 - INFO - app.services.email_processor - [PROCESSOR] Processing email 1/1: ID=19597be3c5a6cf45, Subject='Fwd: 2025-03-14 23:42:35 (M6.0...', From=sunkay subscription <sunkay.subscriptions@gmail.com>, Received=2025-03-14T22:59:41-04:00
2025-03-14 22:59:50 - INFO - app.services.email_processor - [PROCESSOR] Email 19597be3c5a6cf45 is new, creating
2025-03-14 22:59:50 - INFO - app.services.email_processor - [CATEGORIZER] Categorizing email 19597be3c5a6cf45 with subject 'Fwd: 2025-03-14 23:42:35 (M6.0) South Sandwich Islands region -55.7 -27.1 (96494)'
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT] ========== CATEGORIZING EMAIL ==========
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT] Email: ID=19597be3c5a6cf45 | From=sunkay subscription <sunkay.subscriptions@gmail.com> | Subject='Fwd: 2025-03-14 23:42:35 (M6.0) South Sandwich Islands region -55.7 -27.1 (96494)'
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] Starting categorization process
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] Checking Gmail labels...
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_LABELS] Checking labels: UNREAD, IMPORTANT, SENT, INBOX
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_LABELS] Matched label 'SENT' to category 'sent'
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_LABELS] Matched label 'INBOX' to category 'inbox'
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_LABELS] Best match: 'sent' (gmail_label:SENT)
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] Labels match: 'sent' with confidence 1.00 (gmail_label:SENT)
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] Checking subject keywords...
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_KEYWORDS] Checking subject: 'Fwd: 2025-03-14 23:42:35 (M6.0) South Sandwich Islands region -55.7 -27.1 (96494)'
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_KEYWORDS] No keyword matches found in subject
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] No matching subject keywords found
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] Checking sender patterns...
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_SENDER] Checking sender: sunkay subscription <sunkay.subscriptions@gmail.com>
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_SENDER] No sender matches found
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] No matching sender patterns found
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] Checking ML classification...
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_ML] Running ML classification
2025-03-14 22:59:50 - INFO - app.utils.naive_bayes_classifier - [ML-CLASSIFIER] Classifying email: ID=19597be3c5a6cf45, Subject='Fwd: 2025-03-14 23:42:35 (M6.0...', From=sunkay subscription <sunkay.subscriptions@gmail.com>
2025-03-14 22:59:50 - DEBUG - app.utils.naive_bayes_classifier - [ML-CLASSIFIER] Loading user-specific model for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 22:59:50 - INFO - app.services.email_classifier_service - [ML-SERVICE] Ensuring models directory exists at /Users/sunilkayiti/email_agent/models
2025-03-14 22:59:50 - INFO - app.services.email_classifier_service - [ML-SERVICE] Models directory exists and is writable at /Users/sunilkayiti/email_agent/models
2025-03-14 22:59:50 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using user-specific model for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 22:59:50 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] User-specific model not found at /Users/sunilkayiti/email_agent/models/trash_classifier_2b743c51-aa25-4472-98d4-f15f3df955b1.pkl
2025-03-14 22:59:50 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 22:59:50 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 22:59:50 - INFO - app.services.email_classifier_service - [ML-SERVICE] Successfully loaded requested model for global use from /Users/sunilkayiti/email_agent/models/trash_classifier_global.pkl
2025-03-14 22:59:50 - WARNING - app.utils.naive_bayes_classifier - [ML-CLASSIFIER] Model not trained yet, returning default classification for 19597be3c5a6cf45
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_ML] ML prediction: 'not_trash' with confidence 0.5000
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_ML] ML classification as 'not_trash': sender:gmail.com>, content_word:ens, content_word:usgs, content_word:2025
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] ML did not classify as trash
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] Found 1 potential categories, resolving...
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] Candidate: 'sent' (priority=40, confidence=1.00)
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] Selected: 'sent' with confidence 1.00 (gmail_label:SENT)
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT] RESULT: Email categorized as 'sent' with confidence 1.00
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT] REASON: gmail_label:SENT
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT] ========== CATEGORIZATION COMPLETE ==========
2025-03-14 22:59:50 - INFO - app.services.email_processor - [CATEGORIZER] Email 19597be3c5a6cf45 categorized as 'sent'
2025-03-14 22:59:50 - INFO - app.services.email_processor - [IMPORTANCE] Calculating importance for email 19597be3c5a6cf45
2025-03-14 22:59:50 - DEBUG - app.services.email_processor - [IMPORTANCE] +20 for IMPORTANT label -> 70
2025-03-14 22:59:50 - DEBUG - app.services.email_processor - [IMPORTANCE] No category available, categorizing email 19597be3c5a6cf45
2025-03-14 22:59:50 - INFO - app.services.email_processor - [CATEGORIZER] Categorizing email 19597be3c5a6cf45 with subject 'Fwd: 2025-03-14 23:42:35 (M6.0) South Sandwich Islands region -55.7 -27.1 (96494)'
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT] ========== CATEGORIZING EMAIL ==========
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT] Email: ID=19597be3c5a6cf45 | From=sunkay subscription <sunkay.subscriptions@gmail.com> | Subject='Fwd: 2025-03-14 23:42:35 (M6.0) South Sandwich Islands region -55.7 -27.1 (96494)'
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] Starting categorization process
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] Checking Gmail labels...
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_LABELS] Checking labels: UNREAD, IMPORTANT, SENT, INBOX
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_LABELS] Matched label 'SENT' to category 'sent'
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_LABELS] Matched label 'INBOX' to category 'inbox'
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_LABELS] Best match: 'sent' (gmail_label:SENT)
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] Labels match: 'sent' with confidence 1.00 (gmail_label:SENT)
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] Checking subject keywords...
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_KEYWORDS] Checking subject: 'Fwd: 2025-03-14 23:42:35 (M6.0) South Sandwich Islands region -55.7 -27.1 (96494)'
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_KEYWORDS] No keyword matches found in subject
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] No matching subject keywords found
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] Checking sender patterns...
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_SENDER] Checking sender: sunkay subscription <sunkay.subscriptions@gmail.com>
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_SENDER] No sender matches found
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] No matching sender patterns found
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] Checking ML classification...
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_ML] Running ML classification
2025-03-14 22:59:50 - INFO - app.utils.naive_bayes_classifier - [ML-CLASSIFIER] Classifying email: ID=19597be3c5a6cf45, Subject='Fwd: 2025-03-14 23:42:35 (M6.0...', From=sunkay subscription <sunkay.subscriptions@gmail.com>
2025-03-14 22:59:50 - DEBUG - app.utils.naive_bayes_classifier - [ML-CLASSIFIER] Using cached model for 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 22:59:50 - WARNING - app.utils.naive_bayes_classifier - [ML-CLASSIFIER] Model not trained yet, returning default classification for 19597be3c5a6cf45
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_ML] ML prediction: 'not_trash' with confidence 0.5000
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_ML] ML classification as 'not_trash': sender:gmail.com>, content_word:ens, content_word:usgs, content_word:2025
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] ML did not classify as trash
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] Found 1 potential categories, resolving...
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] Candidate: 'sent' (priority=40, confidence=1.00)
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT_COMPOSITE] Selected: 'sent' with confidence 1.00 (gmail_label:SENT)
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT] RESULT: Email categorized as 'sent' with confidence 1.00
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT] REASON: gmail_label:SENT
2025-03-14 22:59:50 - INFO - app.utils.email_categorizer - [EMAIL_CAT] ========== CATEGORIZATION COMPLETE ==========
2025-03-14 22:59:50 - INFO - app.services.email_processor - [CATEGORIZER] Email 19597be3c5a6cf45 categorized as 'sent'
2025-03-14 22:59:50 - DEBUG - app.services.email_processor - [IMPORTANCE] +5 for unread status -> 75
2025-03-14 22:59:50 - INFO - app.services.email_processor - [IMPORTANCE] Final score for email 19597be3c5a6cf45: 75
2025-03-14 22:59:50 - INFO - app.services.email_processor - [PROCESSOR] Categorized as 'sent' with importance 75
2025-03-14 22:59:50 - INFO - app.services.email_processor - [PROCESSOR] Committing 1 emails to database
2025-03-14 22:59:50 - INFO - app.services.email_processor - [PROCESSOR] Successfully processed 1 emails (1 new, 0 updated)
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - [SYNC] Successfully processed and stored 1 emails
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - [SYNC] Email 1/1: ID=06b434a0-13f1-4afa-b427-57a56f734e01, Subject='Fwd: 2025-03-14 23:42:35 (M6.0...', From=sunkay subscription <sunkay.subscriptions@gmail.com>, Received=2025-03-15 02:59:41+00:00, Category=sent
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - [SYNC] Marking 1 emails as deleted
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - [SYNC] Sample deleted Gmail IDs: ['19597be2d0fc5c48']
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - [SYNC] Database Gmail ID format sample: ['19597be3c5a6cf45']
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - [SYNC] Found 0 of the first 1 deleted emails in DB
2025-03-14 22:59:50 - DEBUG - app.services.email_sync_service - [SYNC] Email with gmail_id 19597be2d0fc5c48 not found in database
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - [SYNC] Deletion summary before commit: deleted_count=0, not_found_count=1, already_deleted_count=0
2025-03-14 22:59:50 - WARNING - app.services.email_sync_service - [SYNC] No emails were updated with TRASH label despite finding 1 deleted emails
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - [SYNC] All deleted emails were either not found (1) or already marked as deleted (0)
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - [SYNC] Deleted emails summary: 0 marked as deleted, 1 not found in database, 0 already marked as deleted
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - [SYNC] Updating last_fetched_at to 2025-03-15 02:59:50.490415+00:00
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - [SYNC] Updating last_history_id to 1949690
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - [SYNC] Updated checkpoint from 2025-03-15T02:59:50.490415+00:00 to 2025-03-15T02:59:50.490415+00:00
2025-03-14 22:59:50 - INFO - app.services.email_sync_service - [SYNC] Sync completed successfully: {'status': 'success', 'message': 'Processed 1 new emails, 1 deleted emails, and 0 label changes, 0 category updates', 'sync_count': 2, 'new_email_count': 1, 'deleted_email_count': 1, 'label_changes_count': 0, 'category_updates_processed': 0, 'sync_started_at': '2025-03-15T02:59:50.490415+00:00', 'user_id': '2b743c51-aa25-4472-98d4-f15f3df955b1', 'sync_method': 'history'}
2025-03-14 22:59:50 - INFO - app.routers.emails - [API] Sync completed in 0.29 seconds
2025-03-14 22:59:50 - INFO - app.routers.emails - [API] Sync result: {'status': 'success', 'message': 'Processed 1 new emails, 1 deleted emails, and 0 label changes, 0 category updates', 'sync_count': 2, 'new_email_count': 1, 'deleted_email_count': 1, 'label_changes_count': 0, 'category_updates_processed': 0, 'sync_started_at': '2025-03-15T02:59:50.490415+00:00', 'user_id': '2b743c51-aa25-4472-98d4-f15f3df955b1', 'sync_method': 'history'}
2025-03-14 22:59:50 - INFO - app.routers.emails - [API] Found 1 emails for page 1 (total: 2)
2025-03-14 22:59:50 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 22:59:50 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 22:59:50 - INFO - app.routers.emails - Found 1 emails for page 1 (total: 1)
2025-03-14 23:00:24 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:00:24 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:00:29 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:00:29 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:00:29 - INFO - app.routers.emails - Found 1 emails for page 1 (total: 1)
2025-03-14 23:00:29 - INFO - app.routers.emails - Found 1 emails for page 1 (total: 1)
2025-03-14 23:01:42 - DEBUG - app.dependencies - Authentication cache expired for token: eyJhbGciOi...
2025-03-14 23:01:42 - DEBUG - app.dependencies - Authentication cache expired for token: eyJhbGciOi...
2025-03-14 23:01:42 - DEBUG - app.dependencies - Authenticating user with token: eyJhbGciOi...
2025-03-14 23:01:42 - DEBUG - app.dependencies - Decoding JWT token with SECRET_KEY: cf7d7...
2025-03-14 23:01:42 - DEBUG - app.dependencies - Decoded JWT token, user_email: sunkay.subscriptions@gmail.com
2025-03-14 23:01:42 - DEBUG - app.dependencies - Found user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:02:57 - DEBUG - app.dependencies - Authentication cache expired for token: eyJhbGciOi...
2025-03-14 23:02:57 - DEBUG - app.dependencies - Authenticating user with token: eyJhbGciOi...
2025-03-14 23:02:57 - DEBUG - app.dependencies - Decoding JWT token with SECRET_KEY: cf7d7...
2025-03-14 23:02:57 - DEBUG - app.dependencies - Decoded JWT token, user_email: sunkay.subscriptions@gmail.com
2025-03-14 23:02:57 - DEBUG - app.dependencies - Found user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:02:57 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:02:57 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:02:57 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:02:57 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:02:57 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Ensuring models directory exists at /Users/sunilkayiti/email_agent/models
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Models directory exists and is writable at /Users/sunilkayiti/email_agent/models
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using user-specific model for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] User-specific model not found at /Users/sunilkayiti/email_agent/models/trash_classifier_2b743c51-aa25-4472-98d4-f15f3df955b1.pkl
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Successfully loaded requested model for global use from /Users/sunilkayiti/email_agent/models/trash_classifier_global.pkl
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Evaluating trash classifier for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Ensuring models directory exists at /Users/sunilkayiti/email_agent/models
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Models directory exists and is writable at /Users/sunilkayiti/email_agent/models
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using user-specific model for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] User-specific model not found at /Users/sunilkayiti/email_agent/models/trash_classifier_2b743c51-aa25-4472-98d4-f15f3df955b1.pkl
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Successfully loaded requested model for global use from /Users/sunilkayiti/email_agent/models/trash_classifier_global.pkl
2025-03-14 23:02:57 - ERROR - app.services.email_classifier_service - [ML-SERVICE] No test data available for evaluation
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Ensuring models directory exists at /Users/sunilkayiti/email_agent/models
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Models directory exists and is writable at /Users/sunilkayiti/email_agent/models
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using user-specific model for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] User-specific model not found at /Users/sunilkayiti/email_agent/models/trash_classifier_2b743c51-aa25-4472-98d4-f15f3df955b1.pkl
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Successfully loaded requested model for global use from /Users/sunilkayiti/email_agent/models/trash_classifier_global.pkl
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Ensuring models directory exists at /Users/sunilkayiti/email_agent/models
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Models directory exists and is writable at /Users/sunilkayiti/email_agent/models
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using user-specific model for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] User-specific model not found at /Users/sunilkayiti/email_agent/models/trash_classifier_2b743c51-aa25-4472-98d4-f15f3df955b1.pkl
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Successfully loaded requested model for global use from /Users/sunilkayiti/email_agent/models/trash_classifier_global.pkl
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Ensuring models directory exists at /Users/sunilkayiti/email_agent/models
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Models directory exists and is writable at /Users/sunilkayiti/email_agent/models
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using user-specific model for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] User-specific model not found at /Users/sunilkayiti/email_agent/models/trash_classifier_2b743c51-aa25-4472-98d4-f15f3df955b1.pkl
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Successfully loaded requested model for global use from /Users/sunilkayiti/email_agent/models/trash_classifier_global.pkl
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Evaluating trash classifier for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Ensuring models directory exists at /Users/sunilkayiti/email_agent/models
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Models directory exists and is writable at /Users/sunilkayiti/email_agent/models
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using user-specific model for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] User-specific model not found at /Users/sunilkayiti/email_agent/models/trash_classifier_2b743c51-aa25-4472-98d4-f15f3df955b1.pkl
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Successfully loaded requested model for global use from /Users/sunilkayiti/email_agent/models/trash_classifier_global.pkl
2025-03-14 23:02:57 - ERROR - app.services.email_classifier_service - [ML-SERVICE] No test data available for evaluation
2025-03-14 23:02:57 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:02:57 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Ensuring models directory exists at /Users/sunilkayiti/email_agent/models
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Models directory exists and is writable at /Users/sunilkayiti/email_agent/models
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using user-specific model for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] User-specific model not found at /Users/sunilkayiti/email_agent/models/trash_classifier_2b743c51-aa25-4472-98d4-f15f3df955b1.pkl
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Successfully loaded requested model for global use from /Users/sunilkayiti/email_agent/models/trash_classifier_global.pkl
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Evaluating trash classifier for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Ensuring models directory exists at /Users/sunilkayiti/email_agent/models
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Models directory exists and is writable at /Users/sunilkayiti/email_agent/models
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using user-specific model for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] User-specific model not found at /Users/sunilkayiti/email_agent/models/trash_classifier_2b743c51-aa25-4472-98d4-f15f3df955b1.pkl
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Successfully loaded requested model for global use from /Users/sunilkayiti/email_agent/models/trash_classifier_global.pkl
2025-03-14 23:02:57 - ERROR - app.services.email_classifier_service - [ML-SERVICE] No test data available for evaluation
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Ensuring models directory exists at /Users/sunilkayiti/email_agent/models
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Models directory exists and is writable at /Users/sunilkayiti/email_agent/models
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using user-specific model for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] User-specific model not found at /Users/sunilkayiti/email_agent/models/trash_classifier_2b743c51-aa25-4472-98d4-f15f3df955b1.pkl
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Successfully loaded requested model for global use from /Users/sunilkayiti/email_agent/models/trash_classifier_global.pkl
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Evaluating trash classifier for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Ensuring models directory exists at /Users/sunilkayiti/email_agent/models
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Models directory exists and is writable at /Users/sunilkayiti/email_agent/models
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using user-specific model for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] User-specific model not found at /Users/sunilkayiti/email_agent/models/trash_classifier_2b743c51-aa25-4472-98d4-f15f3df955b1.pkl
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:02:57 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:02:57 - INFO - app.services.email_classifier_service - [ML-SERVICE] Successfully loaded requested model for global use from /Users/sunilkayiti/email_agent/models/trash_classifier_global.pkl
2025-03-14 23:02:57 - ERROR - app.services.email_classifier_service - [ML-SERVICE] No test data available for evaluation
2025-03-14 23:03:03 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:03:03 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:03:03 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:03:03 - INFO - app.services.email_classifier_service - [ML-SERVICE] Ensuring models directory exists at /Users/sunilkayiti/email_agent/models
2025-03-14 23:03:03 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:03:03 - INFO - app.services.email_classifier_service - [ML-SERVICE] Models directory exists and is writable at /Users/sunilkayiti/email_agent/models
2025-03-14 23:03:03 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using user-specific model for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 23:03:03 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] User-specific model not found at /Users/sunilkayiti/email_agent/models/trash_classifier_2b743c51-aa25-4472-98d4-f15f3df955b1.pkl
2025-03-14 23:03:03 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:03:03 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:03:03 - INFO - app.services.email_classifier_service - [ML-SERVICE] Successfully loaded requested model for global use from /Users/sunilkayiti/email_agent/models/trash_classifier_global.pkl
2025-03-14 23:03:03 - INFO - app.services.email_classifier_service - [ML-SERVICE] Ensuring models directory exists at /Users/sunilkayiti/email_agent/models
2025-03-14 23:03:03 - INFO - app.services.email_classifier_service - [ML-SERVICE] Models directory exists and is writable at /Users/sunilkayiti/email_agent/models
2025-03-14 23:03:03 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using user-specific model for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 23:03:03 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] User-specific model not found at /Users/sunilkayiti/email_agent/models/trash_classifier_2b743c51-aa25-4472-98d4-f15f3df955b1.pkl
2025-03-14 23:03:03 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:03:03 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:03:03 - INFO - app.services.email_classifier_service - [ML-SERVICE] Successfully loaded requested model for global use from /Users/sunilkayiti/email_agent/models/trash_classifier_global.pkl
2025-03-14 23:03:03 - INFO - app.services.email_classifier_service - [ML-SERVICE] Evaluating trash classifier for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 23:03:03 - INFO - app.services.email_classifier_service - [ML-SERVICE] Ensuring models directory exists at /Users/sunilkayiti/email_agent/models
2025-03-14 23:03:03 - INFO - app.services.email_classifier_service - [ML-SERVICE] Models directory exists and is writable at /Users/sunilkayiti/email_agent/models
2025-03-14 23:03:03 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using user-specific model for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 23:03:03 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] User-specific model not found at /Users/sunilkayiti/email_agent/models/trash_classifier_2b743c51-aa25-4472-98d4-f15f3df955b1.pkl
2025-03-14 23:03:03 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:03:03 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:03:03 - INFO - app.services.email_classifier_service - [ML-SERVICE] Successfully loaded requested model for global use from /Users/sunilkayiti/email_agent/models/trash_classifier_global.pkl
2025-03-14 23:03:03 - ERROR - app.services.email_classifier_service - [ML-SERVICE] No test data available for evaluation
2025-03-14 23:03:03 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:03:03 - INFO - app.services.email_classifier_service - [ML-SERVICE] Ensuring models directory exists at /Users/sunilkayiti/email_agent/models
2025-03-14 23:03:03 - INFO - app.services.email_classifier_service - [ML-SERVICE] Models directory exists and is writable at /Users/sunilkayiti/email_agent/models
2025-03-14 23:03:03 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using user-specific model for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 23:03:03 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] User-specific model not found at /Users/sunilkayiti/email_agent/models/trash_classifier_2b743c51-aa25-4472-98d4-f15f3df955b1.pkl
2025-03-14 23:03:03 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:03:03 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:03:03 - INFO - app.services.email_classifier_service - [ML-SERVICE] Successfully loaded requested model for global use from /Users/sunilkayiti/email_agent/models/trash_classifier_global.pkl
2025-03-14 23:03:03 - INFO - app.services.email_classifier_service - [ML-SERVICE] Evaluating trash classifier for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 23:03:03 - INFO - app.services.email_classifier_service - [ML-SERVICE] Ensuring models directory exists at /Users/sunilkayiti/email_agent/models
2025-03-14 23:03:03 - INFO - app.services.email_classifier_service - [ML-SERVICE] Models directory exists and is writable at /Users/sunilkayiti/email_agent/models
2025-03-14 23:03:03 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using user-specific model for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 23:03:03 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] User-specific model not found at /Users/sunilkayiti/email_agent/models/trash_classifier_2b743c51-aa25-4472-98d4-f15f3df955b1.pkl
2025-03-14 23:03:03 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:03:03 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:03:03 - INFO - app.services.email_classifier_service - [ML-SERVICE] Successfully loaded requested model for global use from /Users/sunilkayiti/email_agent/models/trash_classifier_global.pkl
2025-03-14 23:03:03 - ERROR - app.services.email_classifier_service - [ML-SERVICE] No test data available for evaluation
2025-03-14 23:03:08 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:03:08 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:03:08 - INFO - app.routers.emails - Found 1 emails for page 1 (total: 1)
2025-03-14 23:21:06 - DEBUG - app.main - Application shutting down
2025-03-14 23:21:08 - INFO - app.core.logging_config - Logging configured. Log file: logs/email_agent.log
2025-03-14 23:21:08 - INFO - app.main - Starting Email Agent API
2025-03-14 23:21:08 - DEBUG - app.main - Starting application initialization
2025-03-14 23:21:08 - DEBUG - app.main - Configuring CORS middleware
2025-03-14 23:21:08 - DEBUG - app.main - Starting application initialization
2025-03-14 23:21:08 - INFO - app.services.email_classifier_service - [ML-SERVICE] Ensuring models directory exists at /Users/sunilkayiti/email_agent/models
2025-03-14 23:21:08 - INFO - app.services.email_classifier_service - [ML-SERVICE] Models directory exists and is writable at /Users/sunilkayiti/email_agent/models
2025-03-14 23:21:08 - INFO - app.main - Models directory created/verified successfully
2025-03-14 23:21:08 - INFO - app.services.email_classifier_service - [ML-SERVICE] Ensuring models directory exists at /Users/sunilkayiti/email_agent/models
2025-03-14 23:21:08 - INFO - app.services.email_classifier_service - [ML-SERVICE] Models directory exists and is writable at /Users/sunilkayiti/email_agent/models
2025-03-14 23:21:08 - INFO - app.services.email_classifier_service - [ML-SERVICE] Found global model at /Users/sunilkayiti/email_agent/models/trash_classifier_global.pkl
2025-03-14 23:21:08 - INFO - app.services.email_classifier_service - [ML-SERVICE] Found 1 user-specific models
2025-03-14 23:21:08 - INFO - app.main - Found 2 classifier model(s)
2025-03-14 23:21:08 - INFO - app.services.email_classifier_service - [ML-SERVICE] Ensuring models directory exists at /Users/sunilkayiti/email_agent/models
2025-03-14 23:21:08 - INFO - app.services.email_classifier_service - [ML-SERVICE] Models directory exists and is writable at /Users/sunilkayiti/email_agent/models
2025-03-14 23:21:08 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:21:08 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:21:08 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:21:08 - INFO - app.services.email_classifier_service - [ML-SERVICE] Successfully loaded requested model for global use from /Users/sunilkayiti/email_agent/models/trash_classifier_global.pkl
2025-03-14 23:21:08 - INFO - app.main - Trash classifier model loaded successfully
2025-03-14 23:21:08 - DEBUG - app.services.email_classifier_service - [ML-SERVICE] Using global model
2025-03-14 23:21:08 - INFO - app.main - Expected global model path: /Users/sunilkayiti/email_agent/models/trash_classifier_global.pkl
2025-03-14 23:21:08 - DEBUG - app.main - Application initialization complete
2025-03-14 23:21:25 - DEBUG - app.dependencies - Authenticating user with token: eyJhbGciOi...
2025-03-14 23:21:25 - DEBUG - app.dependencies - Decoding JWT token with SECRET_KEY: cf7d7...
2025-03-14 23:21:25 - DEBUG - app.dependencies - Decoded JWT token, user_email: sunkay.subscriptions@gmail.com
2025-03-14 23:21:26 - DEBUG - app.dependencies - Authenticating user with token: eyJhbGciOi...
2025-03-14 23:21:26 - DEBUG - app.dependencies - Decoding JWT token with SECRET_KEY: cf7d7...
2025-03-14 23:21:26 - DEBUG - app.dependencies - Decoded JWT token, user_email: sunkay.subscriptions@gmail.com
2025-03-14 23:21:26 - DEBUG - app.dependencies - Found user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:21:26 - DEBUG - app.dependencies - Updating last_sign_in for user 2b743c51-aa25-4472-98d4-f15f3df955b1
2025-03-14 23:21:26 - DEBUG - app.dependencies - Found user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:21:26 - INFO - app.routers.emails - Found 1 emails for page 1 (total: 1)
2025-03-14 23:21:44 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:21:44 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:21:50 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:21:50 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:21:50 - INFO - app.routers.emails - Found 1 emails for page 1 (total: 1)
2025-03-14 23:21:50 - INFO - app.routers.emails - Found 1 emails for page 1 (total: 1)
2025-03-14 23:21:51 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:21:52 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:21:52 - INFO - app.routers.emails - Found 1 emails for page 1 (total: 1)
2025-03-14 23:22:39 - DEBUG - app.dependencies - Authentication cache expired for token: eyJhbGciOi...
2025-03-14 23:22:39 - DEBUG - app.dependencies - Authentication cache expired for token: eyJhbGciOi...
2025-03-14 23:22:39 - DEBUG - app.dependencies - Authenticating user with token: eyJhbGciOi...
2025-03-14 23:22:39 - DEBUG - app.dependencies - Decoding JWT token with SECRET_KEY: cf7d7...
2025-03-14 23:22:39 - DEBUG - app.dependencies - Decoded JWT token, user_email: sunkay.subscriptions@gmail.com
2025-03-14 23:22:39 - DEBUG - app.dependencies - Found user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:22:41 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:22:41 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:22:41 - INFO - app.routers.emails - Found 1 emails for page 1 (total: 1)
2025-03-14 23:22:41 - INFO - app.routers.emails - Found 1 emails for page 1 (total: 1)
2025-03-14 23:22:46 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:22:46 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:22:58 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:22:58 - INFO - app.routers.emails - Found 1 emails for page 1 (total: 1)
2025-03-14 23:22:58 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:22:58 - INFO - app.routers.emails - Found 1 emails for page 1 (total: 1)
2025-03-14 23:24:35 - DEBUG - app.dependencies - Authentication cache expired for token: eyJhbGciOi...
2025-03-14 23:24:35 - DEBUG - app.dependencies - Authenticating user with token: eyJhbGciOi...
2025-03-14 23:24:35 - DEBUG - app.dependencies - Decoding JWT token with SECRET_KEY: cf7d7...
2025-03-14 23:24:35 - DEBUG - app.dependencies - Decoded JWT token, user_email: sunkay.subscriptions@gmail.com
2025-03-14 23:24:35 - DEBUG - app.dependencies - Found user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:24:35 - DEBUG - app.dependencies - Using cached authentication for user: sunkay.subscriptions@gmail.com (ID: 2b743c51-aa25-4472-98d4-f15f3df955b1)
2025-03-14 23:24:35 - INFO - app.routers.emails - Found 1 emails for page 1 (total: 1)
